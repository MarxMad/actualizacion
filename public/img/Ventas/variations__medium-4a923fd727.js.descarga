!function(t,e,i){"use strict";function s(t){this["super"]=t["super"],this.element=t.element,this.position=t.position,this.attributeId=t.attributeId,this.type=this.element.getAttribute("data-type"),this.title=this.element.getAttribute("data-title"),this.status=this.element.getAttribute("data-status"),this.value=this.element.getAttribute("data-value"),this.ui={link:this.element.querySelector("a")},this.statusClasses={selected:"variations-selected",disabled:"variations-disabled"},this.bindEvents()}s.prototype.isAble=function(){var t=this,e=!1;return this["super"]["super"].whiteList[this.attributeId].forEach(function(i){i.attribute_combinations.forEach(function(i){i.value_id===t.value&&i.id===t["super"].id&&(e=!0)})}),e},s.prototype.reset=function(){this.status="enabled",tiny.removeClass(this.element,this.statusClasses.disabled),tiny.removeClass(this.element,this.statusClasses.selected)},s.prototype.select=function(){this.status="selected",tiny.removeClass(this.element,this.statusClasses.disabled),tiny.addClass(this.element,this.statusClasses.selected),this["super"].setSelectedValue(this.value)},s.prototype.disabled=function(){this.status="disabled",tiny.removeClass(this.element,this.statusClasses.selected),tiny.addClass(this.element,this.statusClasses.disabled)},s.prototype.bindEvents=function(){var t=this,e=function(e){e&&e.preventDefault(),t["super"].closeDropdown(),"selected"!==t.status&&(meli.emit("variations:selected",{pickerSelected:t}),t["super"].updateTitle(t.title),t["super"].updateDropdown(t.element),t["super"].validate())};tiny.on(this.ui.link,"click",e),meli.on("fitanalytics:recommend",function(i){var s=i.result,n=i.callback,a=i.autoSelect,r=t.title;r===s&&(n&&n(t["super"],a),e())})},i.Picker=s}(window,document,Meli.prototype),function(t,e,i){"use strict";function s(t){this["super"]=t["super"],this.element=t.element,this.id=this.element.getAttribute("data-id"),this.text=t.text,this.ui={pickers:this.element.querySelectorAll(".vip-variation-list li"),title:this.element.querySelector(".variations-title strong"),dropdownContainer:this.element.querySelector(".ui-dropdown__container"),dropdown:this.element.querySelector(".ui-dropdown__input"),dropdownSelect:this.element.querySelector(".variation-title--trigger"),dropdownTitle:this.element.querySelector(".variation-title__content")},this.pickerInstances=[],this.selectedValue=null,this.statusClasses={validate:"variations-attribute-validate",dropdownSelected:"variation-title--trigger-selected"},this.createPickerInstances(),this.bindEvents()}s.prototype.createPickerInstances=function(){var t;for(t=0;t<this.ui.pickers.length;t+=1){var e=new meli.Picker({element:this.ui.pickers[t],position:t,"super":this,attributeId:this.id});this.pickerInstances.push(e),"selected"===e.status&&(this.selectedValue=e.value)}},s.prototype.setSelectedValue=function(t){this.selectedValue=t},s.prototype.getSelectedValue=function(t){return this.selectedValue},s.prototype.resetPickers=function(){var t;for(t=0;t<this.pickerInstances.length;t+=1)this.pickerInstances[t].reset();this.updateTitle(""),this.resetDropdown(),this.setSelectedValue(null)},s.prototype.disablePickers=function(){var t;for(t=0;t<this.pickerInstances.length;t+=1){var e=this.pickerInstances[t];e.isAble()?e.isAble()&&"selected"!==e.status&&e.reset():(e.reset(),e.disabled())}},s.prototype.removeSelected=function(){var t;for(t=0;t<this.pickerInstances.length;t+=1){var e=this.pickerInstances[t];"selected"===e.status&&e.reset()}},s.prototype.updateTitle=function(t){this.ui.title.innerHTML=t},s.prototype.updateDropdown=function(t){if(null!==this.ui.dropdown&&t){var e=t.querySelector(".ui-list__item-option");e&&(this.ui.dropdownTitle.innerHTML=e.innerHTML,tiny.addClass(this.ui.dropdownSelect,this.statusClasses.dropdownSelected))}},s.prototype.resetDropdown=function(){null!==this.ui.dropdown&&(this.ui.dropdownTitle.innerHTML=this.text.dropdown,tiny.removeClass(this.ui.dropdownSelect,this.statusClasses.dropdownSelected))},s.prototype.validate=function(){this.selectedValue?tiny.removeClass(this.element,this.statusClasses.validate):(tiny.addClass(this.element,this.statusClasses.validate),this.updateTitle(this.text.validateText),this.resetDropdown())},s.prototype.closeDropdown=function(){null!==this.ui.dropdown&&(this.ui.dropdown.checked=!1)},s.prototype.bindEvents=function(){var t=this;meli.on("variations:validate",function(e,i){t.validate()}),tiny.on(t.ui.dropdown,"change",function(e){this.checked&&meli.emit("variations:closeDropdown",{attributeId:t.id})}),meli.on("variations:closeDropdown",function(e){e.attributeId!==t.id&&t.closeDropdown()}),tiny.on(document,"click",function(e){if(t.ui.dropdownContainer){var i=t.ui.dropdownContainer.contains(e.target);i||t.closeDropdown()}})},i.Attribute=s}(window,document,Meli.prototype),function(t,e,i){"use strict";function s(t){if(!t.model)throw new Error("Variations model is required");this.model=t.model,this.variationsImageHash=t.variationsImageHash,this.text=t.text,this.element=e.querySelector('[data-js="vip-variation"]'),this.ui={container:this.element.querySelector('[data-js="variations-container"]'),inputHidden:this.element.querySelector('[data-js="variations-input"]'),attributes:this.element.querySelectorAll('[data-js="variations-attribute"]'),subscriptionsVariationsContainer:e.querySelector(".subscriptions-variations-container")||{},buyVariationsContainer:e.querySelector(".buy-variations-container")||{}},this.whiteList=[],this.attributesInstances={},this.attributesLength=0,this.createAttributesInstances(),this.updateWhiteList(),this.bindEvents(),this.updateInputHidden()}s.prototype.createAttributesInstances=function(){for(var t=0;t<this.ui.attributes.length;t+=1){var e=new meli.Attribute({element:this.ui.attributes[t],position:t,"super":this,text:this.text});this.attributesInstances[this.ui.attributes[t].getAttribute("data-id")]=e,this.attributesLength+=1}},s.prototype.filter=function(t,e,i){var s=[];return t.forEach(function(t){t.available_quantity>0&&t.attribute_combinations.forEach(function(n){n.value_id===i&&n.id===e&&s.push(t)})}),s},s.prototype.resetAllPickers=function(){var t=this;Object.keys(this.attributesInstances).forEach(function(e){t.attributesInstances[e].resetPickers()})},s.prototype.removeOldSelected=function(t){this.attributesInstances[t.attributeId].removePreviousSelected()},s.prototype.disabledPickers=function(t){var e=this;Object.keys(this.attributesInstances).forEach(function(i){i!==t.attributeId&&e.attributesInstances[i].disablePickers()})},s.prototype.updatePickers=function(t){"disabled"===t.status?this.resetAllPickers():this.attributesInstances[t.attributeId].removeSelected(),t.select(),this.updateWhiteList(),this.disabledPickers(t),this.setStaticValidVariations()},s.prototype.isComplete=function(){var t=this,e=!0,i={};return Object.keys(this.attributesInstances).forEach(function(s){var n=t.attributesInstances[s].getSelectedValue();n?i[s]=n:e=!1}),{result:e,values:i}},s.prototype.updateInputHidden=function(){var t=this,e=this.isComplete();if(e.result){var i=this.model;Object.keys(e.values).forEach(function(s){i=t.filter(i,s,e.values[s])}),this.ui.inputHidden.value=i[0].id,meli.emit("variations:complete",{complete:!0,available_quantity:i[0].available_quantity,variationId:this.ui.inputHidden.value}),meli.urlUtils.paramSet("variation",i[0].id)}else this.ui.inputHidden.value="",meli.emit("variations:complete",{complete:!1})},s.prototype.updateWhiteList=function(){var t=this;Object.keys(t.attributesInstances).forEach(function(e){t.whiteList[e]=t.model,Object.keys(t.attributesInstances).forEach(function(i){var s=t.attributesInstances[i].getSelectedValue();i!==e&&s&&(t.whiteList[e]=t.filter(t.whiteList[e],i,s))})})},s.prototype.moveVariationsDom=function(t){"subscriptionTab"===t?(this.ui.subscriptionsVariationsContainer.appendChild(this.element),meli.emit("subscriptionTab:complete")):(this.ui.buyVariationsContainer.appendChild(this.element),meli.emit("buyTab:complete"))},s.prototype.updateGallery=function(){var t=this,e=this.isComplete(),i=this.model;Object.keys(e.values).forEach(function(s){i=t.filter(i,s,e.values[s])});var s=i[0].id?i[0].id.toString():null;meli.emit("variations:changeImage",{variationId:s,galleryHash:this.variationsImageHash[s]})},s.prototype.setStaticValidVariations=function(){var t=this;Object.keys(this.attributesInstances).forEach(function(e){var i=t.attributesInstances[e].pickerInstances;1===i.length&&i[0].isAble()&&(i[0].select(),t.attributesInstances[e].updateTitle(i[0].title))})},s.prototype.bindEvents=function(){var t=this,e=this;meli.on("subscriptionTab:selected",function(){t.moveVariationsDom("subscriptionTab")}),meli.on("buyTab:selected",function(){t.moveVariationsDom("buyTab")}),meli.on("variations:selected",function(t){e.updatePickers(t.pickerSelected),e.updateInputHidden(),e.updateGallery()}),meli.on("variations:clear",function(){e.updateInputHidden(),e.updateGallery()})},i.Variations=s}(window,document,Meli.prototype);
//# sourceMappingURL=../js/variations__medium-4a923fd727.js.map